#include <jni.h>
#include <android/log.h>
#include <dlfcn.h>

#define LOG_TAG "DlopenTest"
#define LOGI(...) __android_log_print(ANDROID_LOG_INFO, LOG_TAG, __VA_ARGS__)
#define LOGE(...) __android_log_print(ANDROID_LOG_ERROR, LOG_TAG, __VA_ARGS__)

extern "C"
JNIEXPORT jboolean JNICALL
Java_com_hellooworldapp_DlopenHelper_tryLoadLibrary(JNIEnv *env, jclass clazz) {
    char libName[] = "libcrypto.so";

    void* handle = dlopen(libName, RTLD_NOW);
    if (handle) {
        LOGI("Successfully loaded %s", libName);
        dlclose(handle);
        return JNI_TRUE;
    } else {
        LOGE("Failed to load %s: %s", libName, dlerror());
        return JNI_FALSE;
    }
}
